function formatNumber(t){return t.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}function convertTime(t){var e=Math.floor(t/60),a=Math.floor(t-60*e);return e+":"+a}function check_for_riveted(t){var e={ids:"ga:"+t,"start-date":start_date,"end-date":end_date,metrics:"ga:eventValue, ga:sessions",dimensions:"ga:eventCategory",filters:"ga:eventCategory==Riveted"};gapi.client.analytics.data.ga.get(e).then(function(t){"rows"in t.result&&console.log("yes")})}function total_time_report(t){var e={ids:"ga:"+t,"start-date":start_date,"end-date":end_date,metrics:"ga:eventValue, ga:sessions",dimensions:"ga:eventCategory",filters:"ga:eventCategory==Riveted"};gapi.client.analytics.data.ga.get(e).then(function(t){var e=(t.result.rows[0][1].toString().toHHMMSS(),parseInt((t.result.rows[0][1]/60).toFixed(0)));console.log(e);var a=t.result.rows[0][1]/t.result.rows[0][2];$("#total-time .data .number").html(moment.duration(e,"minutes").humanize()),$("#avg-time .data .number").html(a.toString().toHHMMSS())})}function time_by_day_report(t){var e={ids:"ga:"+t,"start-date":start_date,"end-date":end_date,metrics:"ga:eventValue",dimensions:"ga:date",filters:"ga:eventCategory==Riveted"};gapi.client.analytics.data.ga.get(e).then(function(t){var e=t.result.rows,a=_.map(e,function(t){return t[0]}),n=_.map(e,function(t){return t[1]});new Chartist.Line(".ct-chart",{labels:a,series:[n]},{chartPadding:{right:40}})})}function pages_report(t){var e={ids:"ga:"+t,"start-date":start_date,"end-date":end_date,metrics:"ga:eventValue, ga:uniqueEvents",dimensions:"ga:eventCategory,ga:pagePath",filters:"ga:eventCategory==Riveted",sort:"-ga:eventValue"};gapi.client.analytics.data.ga.get(e).then(function(t){var e=t.result.rows,a=[];e=e.slice(0,15),e.forEach(function(t){var e=Math.floor(t[2]/t[3]),n=e.toString().toHHMMSS(),r=t[2].toHHMMSS();a.push({page:t[1],time:parseInt(t[2],10),sessions:parseInt(t[3]),avg_seconds:e,avg_readable:n,total_readable:r})});var n=_.sortBy(a,"time").reverse(),r=_.sortBy(a,"avg_seconds").reverse(),s=_.template("<tr><td><%= page %></td><td><%= total_readable %></td></tr>"),i=_.template("<tr><td><%= page %></td><td><%= avg_readable %></td></tr>"),o="",d="";_.each(n,function(t){o+=s(t)}),_.each(r,function(t){d+=i(t)}),$("#top-pages table").append(o),$("#top-pages-avg table").append(d)})}function traffic_sources(t){var e={ids:"ga:"+t,"start-date":start_date,"end-date":end_date,metrics:"ga:eventValue, ga:sessions",dimensions:"ga:eventCategory, ga:channelGrouping",filters:"ga:eventCategory==Riveted"};gapi.client.analytics.data.ga.get(e).then(function(t){var e=t.result.rows,a=[];e.forEach(function(t){var e=Math.floor(t[2]/t[3]);a.push({type:t[1],time:e})});var n=_.map(a,function(t){return t.type}),r=_.map(a,function(t){return t.time}),s={labels:n,series:[r]};new Chartist.Bar(".ct-traffic-sources",s)})}function device_types(t){var e={ids:"ga:"+t,"start-date":start_date,"end-date":end_date,metrics:"ga:eventValue, ga:sessions",dimensions:"ga:eventCategory, ga:deviceCategory",filters:"ga:eventCategory==Riveted"};gapi.client.analytics.data.ga.get(e).then(function(t){var e=t.result.rows,a=[];e.forEach(function(t){var e=Math.floor(t[2]/t[3]);a.push({type:t[1],time:e})});var n=_.map(a,function(t){return t.type}),r=_.map(a,function(t){return t.time}),s={labels:n,series:[r]};new Chartist.Bar(".ct-device-types",s)})}function queryCoreReportingApi(t){console.log(t),total_time_report(t),pages_report(t),traffic_sources(t),device_types(t)}function loadReports(t){var e={ids:"ga:"+t,"start-date":start_date,"end-date":end_date,metrics:"ga:eventValue, ga:sessions",dimensions:"ga:eventCategory",filters:"ga:eventCategory==Riveted"};gapi.client.analytics.data.ga.get(e).then(function(e){"rows"in e.result?(total_time_report(t),pages_report(t),traffic_sources(t),device_types(t),$("#view-status").addClass("hidden"),$(".main").removeClass("hidden")):($("#view-status").removeClass("hidden"),$(".main").addClass("hidden"))})}String.prototype.toHHMMSS=function(){var t=parseInt(this,10),e=Math.floor(t/3600),a=Math.floor((t-3600*e)/60),n=t-3600*e-60*a;10>e&&(e="0"+e),10>a&&(a="0"+a),10>n&&(n="0"+n);var r=e+":"+a+":"+n;return r},gapi.analytics.ready(function(){gapi.analytics.auth.authorize({container:"embed-api-auth-container",clientid:"188932152241-501aofbjdt8raoq9vhkq1rqdd8knn1g5.apps.googleusercontent.com"}),gapi.analytics.auth.on("success",function(){$(".auth-note").hide(),$(".auth h3").html("Authorized")});var t=new gapi.analytics.ViewSelector({container:"view-selector-container"});t.execute(),t.on("change",function(t){var e=t.substring(3);console.log(e),loadReports(e)})});var start_date="30daysAgo",end_date="today";